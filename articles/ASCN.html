<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Allele Specific Copy Number Inference • schnapps</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Allele Specific Copy Number Inference">
<meta property="og:description" content="schnapps">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">schnapps</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ASCN.html">Allele Specific Copy Number Inference</a>
    </li>
    <li>
      <a href="../articles/BetaBinom.html">Beta-Binomial model for schnapps</a>
    </li>
    <li>
      <a href="../articles/karyoplot.html">Advanced plotting with schnapps</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Allele Specific Copy Number Inference</h1>
            
      
      
      <div class="hidden name"><code>ASCN.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">schnapps</span>)</pre></body></html></div>
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>This vignette illustrates how to perform allele specific copy number inference with DLP+ data. However the method should be generally applicable to any single cell copy number method. The input requirements are discussed below.</p>
</div>
<div id="data" class="section level2">
<h2 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h2>
<p>The data needed to perform the allele specific copy number inference are the binned copy number data and cell specific haplotype calls. The copy number data and the haplotype data should use the same bins.</p>
<p>A small test data set of 250 cells is provided with the package, we’ll load this data and inspect these 2 dataframe.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">haplotypes</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">CNbins</span>)</pre></body></html></div>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">CNbins</span>)
<span class="co">#&gt;                 cell_id chr   start     end state     copy</span>
<span class="co">#&gt; 1 SA922-A90554B-R24-C09   1 2000001 2500000     4 4.060400</span>
<span class="co">#&gt; 2 SA922-A90554B-R24-C09   1 3000001 3500000     4 4.284216</span>
<span class="co">#&gt; 3 SA922-A90554B-R24-C09   1 4000001 4500000     4 4.094158</span>
<span class="co">#&gt; 4 SA922-A90554B-R24-C09   1 4500001 5000000     4 4.233719</span>
<span class="co">#&gt; 5 SA922-A90554B-R24-C09   1 5000001 5500000     4 4.151288</span>
<span class="co">#&gt; 6 SA922-A90554B-R24-C09   1 5500001 6000000     4 3.907891</span></pre></body></html></div>
<p>The haplotype data comes in long format, but the package requires data in wide format so we will use the helper function <code>format_haplotypes_dlp</code> to convert the data to the correct format, this function will also remove any bins present in the haplotypes data frame that is not present in the CNbins data frame.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">haplotypes</span> <span class="kw">&lt;-</span> <span class="fu">format_haplotypes_dlp</span>(<span class="no">haplotypes</span>, <span class="no">CNbins</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">haplotypes</span>)
<span class="co">#&gt;                  cell_id chr   start     end hap_label allele1 allele0</span>
<span class="co">#&gt; 1 SA1090-A96213A-R20-C11   1 2000001 2500000       126       1       0</span>
<span class="co">#&gt; 2 SA1090-A96213A-R20-C11   1 2000001 2500000       128       1       0</span>
<span class="co">#&gt; 3 SA1090-A96213A-R20-C11   1 2000001 2500000       130       3       0</span>
<span class="co">#&gt; 4 SA1090-A96213A-R20-C11   1 2000001 2500000       132      11       0</span>
<span class="co">#&gt; 5 SA1090-A96213A-R20-C11   1 2000001 2500000       136       1       0</span>
<span class="co">#&gt; 6 SA1090-A96213A-R20-C11   1 2000001 2500000       142       1       0</span>
<span class="co">#&gt;   totalcounts</span>
<span class="co">#&gt; 1           1</span>
<span class="co">#&gt; 2           1</span>
<span class="co">#&gt; 3           3</span>
<span class="co">#&gt; 4          11</span>
<span class="co">#&gt; 5           1</span>
<span class="co">#&gt; 6           1</span></pre></body></html></div>
</div>
<div id="inference" class="section level2">
<h2 class="hasAnchor">
<a href="#inference" class="anchor"></a>Inference</h2>
<p>The output of <code>schnapps</code> is allele specific states per bin. <code>schnapps</code> has 2 options to perform this inference, the first, <code>callAlleleSpecificCN</code>, infers allele specific states using mirrored B allele frequencies as is typically done in bulk whole genome sequencing. This infers states of the form <code>A|B</code> where <code>B &lt; A</code>. The second option, <code>callHaplotypeSpecificCN</code> takes into account the possibility that different alleles may be lost or gained in different cells. In order to identify these events, <code>schnapps</code> clusters cells and infers the haplotype phase based on regions within clusters that have large allelic imbalance. The output for this method thereofore allows for <code>B&gt;A</code>.</p>
<div id="callallelespecificcn" class="section level3">
<h3 class="hasAnchor">
<a href="#callallelespecificcn" class="anchor"></a><code>callAlleleSpecificCN</code>
</h3>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">ascn</span> <span class="kw">&lt;-</span> <span class="fu">callAlleleSpecificCN</span>(<span class="no">CNbins</span>, <span class="no">haplotypes</span>)</pre></body></html></div>
<p>As a sanity check we can plot the B allele frequency (BAF) as a function of inferred state. We would expect to see a distribution around the expected value which is exactly what we see below.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu">plotBAFperstate</span>(<span class="no">ascn</span>, <span class="kw">maxstate</span> <span class="kw">=</span> <span class="fl">10</span>)</pre></body></html></div>
<p><img src="ASCN_files/figure-html/unnamed-chunk-6-1.png" width="960"></p>
<p>Now we can plot the copy number heatmaps. First we’ll plot the heatmap based on copy number states. By default the <code>plotHeatmap</code> function does some clustering using hdbscan, we’ll set a seed so we get the same clustering for each of the heatmaps below.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1</span>)
<span class="fu">plotHeatmap</span>(<span class="no">ascn</span>, <span class="kw">plotcol</span> <span class="kw">=</span> <span class="st">"state"</span>, <span class="kw">plottree</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">spacer_cols</span> <span class="kw">=</span> <span class="fl">15</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  0  A  B  C  D  E  F  G </span>
<span class="co">#&gt; 10 35 38 25 34 21 38 36</span></pre></body></html></div>
<p><img src="ASCN_files/figure-html/unnamed-chunk-7-1.png" width="960"></p>
<p>Now we can plot some heatmaps to visualize the allele specific state. This heatmap plots the minor copy number state.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu">plotHeatmap</span>(<span class="no">ascn</span>, <span class="kw">plotcol</span> <span class="kw">=</span> <span class="st">"state_min"</span>, <span class="kw">plottree</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">spacer_cols</span> <span class="kw">=</span> <span class="fl">15</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  0  A  B  C  D  E  F  G </span>
<span class="co">#&gt; 10 35 38 25 34 21 38 36</span></pre></body></html></div>
<p><img src="ASCN_files/figure-html/unnamed-chunk-8-1.png" width="960"></p>
<p>Allelic imbalance:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu">plotHeatmap</span>(<span class="no">ascn</span>, <span class="kw">plotcol</span> <span class="kw">=</span> <span class="st">"state_BAF"</span>, <span class="kw">plottree</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">spacer_cols</span> <span class="kw">=</span> <span class="fl">15</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  0  A  B  C  D  E  F  G </span>
<span class="co">#&gt; 10 35 38 25 34 21 38 36</span></pre></body></html></div>
<p><img src="ASCN_files/figure-html/unnamed-chunk-9-1.png" width="960"></p>
<p>Discrete representation of allelic imbalance:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu">plotHeatmap</span>(<span class="no">ascn</span>, <span class="kw">plotcol</span> <span class="kw">=</span> <span class="st">"state_phase"</span>, <span class="kw">plottree</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">spacer_cols</span> <span class="kw">=</span> <span class="fl">15</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  0  A  B  C  D  E  F  G </span>
<span class="co">#&gt; 10 35 38 25 34 21 38 36</span></pre></body></html></div>
<p><img src="ASCN_files/figure-html/unnamed-chunk-10-1.png" width="960"></p>
<p>There are also some function to plot per cell BAF and state plots. You can specify a cell, or the default will take the first cell in the data frame.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu">plotCNprofileBAF</span>(<span class="no">ascn</span>)</pre></body></html></div>
<p><img src="ASCN_files/figure-html/unnamed-chunk-11-1.png" width="960"></p>
<p>Here we’ll plot and equivalent plot merging across cells</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="no">ascn</span>$<span class="no">data</span> <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">chr</span>, <span class="no">start</span>, <span class="no">end</span>) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(<span class="kw">state</span> <span class="kw">=</span> <span class="kw pkg">schnapps</span><span class="kw ns">:::</span><span class="fu">Mode</span>(<span class="no">state</span>),
              <span class="kw">state_min</span> <span class="kw">=</span> <span class="kw pkg">schnapps</span><span class="kw ns">:::</span><span class="fu">Mode</span>(<span class="no">state_min</span>),
              <span class="kw">BAF</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">BAF</span>),
              <span class="kw">state_phase</span> <span class="kw">=</span> <span class="kw pkg">schnapps</span><span class="kw ns">:::</span><span class="fu">Mode</span>(<span class="no">state_phase</span>),
              <span class="kw">copy</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">copy</span>)) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span>() <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">cell_id</span> <span class="kw">=</span> <span class="st">"Merged Cells"</span>) <span class="kw">%&gt;%</span> <span class="co"># add dummy cell id</span>
    <span class="fu">plotCNprofileBAF</span>(<span class="no">.</span>)</pre></body></html></div>
<p><img src="ASCN_files/figure-html/unnamed-chunk-12-1.png" width="960"></p>
<p>The object returned by the inference function is of type <code>ascn</code>, if you want to pull out the data to use in your own scripts you can just do <code>ascn$data</code>. This will return a <code>data.frame</code> similar to the input data frames but with additional columns specifying the allele specific states.</p>
</div>
<div id="callhaplotypespecificcn" class="section level3">
<h3 class="hasAnchor">
<a href="#callhaplotypespecificcn" class="anchor"></a><code>callHaplotypeSpecificCN</code>
</h3>
<p>Now we’ll do the analysis that phases haplotypes across cells.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">hscn</span> <span class="kw">&lt;-</span> <span class="fu">callHaplotypeSpecificCN</span>(<span class="no">CNbins</span>, <span class="no">haplotypes</span>, <span class="kw">phasebyarm</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  A  B  C </span>
<span class="co">#&gt; 73 90 74</span></pre></body></html></div>
<p>We’ll now generate the same plots as before. We can see in the BAF per state plot that we now observe states with BAF &gt; 0.5 meaning that we see different alleles gained or lost in different cells.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu">plotBAFperstate</span>(<span class="no">hscn</span>, <span class="kw">maxstate</span> <span class="kw">=</span> <span class="fl">10</span>)</pre></body></html></div>
<p><img src="ASCN_files/figure-html/unnamed-chunk-14-1.png" width="960"></p>
<p>In the allelic imbalance heatmap we can see that some cells have gained the “B” allele and others the “A” allele resulting in imbalance spanning from 0 to 1.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1</span>)
<span class="fu">plotHeatmap</span>(<span class="no">hscn</span>, <span class="kw">plotcol</span> <span class="kw">=</span> <span class="st">"state_BAF"</span>, <span class="kw">plottree</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">spacer_cols</span> <span class="kw">=</span> <span class="fl">15</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  A  B  C  D  E  F  G </span>
<span class="co">#&gt; 21 25 44 35 38 38 36</span></pre></body></html></div>
<p><img src="ASCN_files/figure-html/unnamed-chunk-15-1.png" width="960"></p>
<p>In the discrete version of this plot we see similar patterns.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1</span>)
<span class="fu">plotHeatmap</span>(<span class="no">hscn</span>, <span class="kw">plotcol</span> <span class="kw">=</span> <span class="st">"state_phase"</span>, <span class="kw">plottree</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">spacer_cols</span> <span class="kw">=</span> <span class="fl">15</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  A  B  C  D  E  F  G </span>
<span class="co">#&gt; 21 25 44 35 38 38 36</span></pre></body></html></div>
<p><img src="ASCN_files/figure-html/unnamed-chunk-16-1.png" width="960"></p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="fu">plotCNprofileBAF</span>(<span class="no">hscn</span>)</pre></body></html></div>
<p><img src="ASCN_files/figure-html/unnamed-chunk-17-1.png" width="960"></p>
<p>Here we’ll merge all cells and plot together.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">hscn</span>$<span class="no">data</span> <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">chr</span>, <span class="no">start</span>, <span class="no">end</span>) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(<span class="kw">state</span> <span class="kw">=</span> <span class="kw pkg">schnapps</span><span class="kw ns">:::</span><span class="fu">Mode</span>(<span class="no">state</span>),
              <span class="kw">state_min</span> <span class="kw">=</span> <span class="kw pkg">schnapps</span><span class="kw ns">:::</span><span class="fu">Mode</span>(<span class="no">state_min</span>),
              <span class="kw">BAF</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">BAF</span>),
              <span class="kw">state_phase</span> <span class="kw">=</span> <span class="kw pkg">schnapps</span><span class="kw ns">:::</span><span class="fu">Mode</span>(<span class="no">state_phase</span>),
              <span class="kw">copy</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="no">copy</span>)) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span>() <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">cell_id</span> <span class="kw">=</span> <span class="st">"Merged Cells"</span>) <span class="kw">%&gt;%</span> <span class="co"># add dummy cell id</span>
    <span class="fu">plotCNprofileBAF</span>(<span class="no">.</span>)</pre></body></html></div>
<p><img src="ASCN_files/figure-html/unnamed-chunk-18-1.png" width="960"></p>
</div>
<div id="dealing-with-noisy-data" class="section level3">
<h3 class="hasAnchor">
<a href="#dealing-with-noisy-data" class="anchor"></a>Dealing with noisy data</h3>
<p>If the coverage per cell is on average low then estimating allele specific copy number can be challenging. This can result in “grainy” heatmaps, noisy cell profiles and inconsistent <code>plotBAFperstate</code> plots. One way to overcome this is to use larger bin sizes, <code>schnapps</code> provides 2 utility functions to “widen” the bins by taking an average across bins.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">CNbins_wide</span> <span class="kw">&lt;-</span> <span class="fu">widen_bins</span>(<span class="no">CNbins</span>, <span class="kw">binsize</span> <span class="kw">=</span> <span class="fl">5e6</span>)
<span class="no">haplotypes_wide</span> <span class="kw">&lt;-</span> <span class="fu">widen_haplotypebins</span>(<span class="no">haplotypes</span>, <span class="kw">binsize</span> <span class="kw">=</span> <span class="fl">5e6</span>)

<span class="no">hscn_wide</span> <span class="kw">&lt;-</span> <span class="fu">callHaplotypeSpecificCN</span>(<span class="no">CNbins_wide</span>, <span class="no">haplotypes_wide</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  A  B  C  D </span>
<span class="co">#&gt; 73 90 37 37</span></pre></body></html></div>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="fu">plotBAFperstate</span>(<span class="no">hscn_wide</span>, <span class="kw">maxstate</span> <span class="kw">=</span> <span class="fl">10</span>)</pre></body></html></div>
<p><img src="ASCN_files/figure-html/unnamed-chunk-20-1.png" width="960"></p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1</span>)
<span class="fu">plotHeatmap</span>(<span class="no">hscn_wide</span>, <span class="kw">plotcol</span> <span class="kw">=</span> <span class="st">"state_BAF"</span>, <span class="kw">plottree</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">spacer_cols</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  0  A  B  C  D  E  F  G </span>
<span class="co">#&gt; 10 37 36 34 25 21 38 36</span></pre></body></html></div>
<p><img src="ASCN_files/figure-html/unnamed-chunk-21-1.png" width="960"></p>
<p>In the discrete version of this plot we see similar patterns.</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1</span>)
<span class="fu">plotHeatmap</span>(<span class="no">hscn_wide</span>, <span class="kw">plotcol</span> <span class="kw">=</span> <span class="st">"state_phase"</span>, <span class="kw">plottree</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">spacer_cols</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  0  A  B  C  D  E  F  G </span>
<span class="co">#&gt; 10 37 36 34 25 21 38 36</span></pre></body></html></div>
<p><img src="ASCN_files/figure-html/unnamed-chunk-22-1.png" width="960"></p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="fu">plotCNprofileBAF</span>(<span class="no">hscn_wide</span>)</pre></body></html></div>
<p><img src="ASCN_files/figure-html/unnamed-chunk-23-1.png" width="960"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
